<!DOCTYPE html>




<html lang="zh-Hans" class=" js flexbox flexboxlegacy no-touch rgba hsla multiplebgs backgroundsize borderimage borderradius boxshadow textshadow opacity cssanimations csscolumns cssgradients cssreflections csstransforms csstransforms3d csstransitions fontface generatedcontent">

<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>hello</title>

 	<link rel="alternate" type="application/rss+xml" title="Weisd » Feed" href="http://replace-this-with-your-hugo-site.com/feed">

	<link rel="stylesheet" id="rotatingtweets-css" href="http://replace-this-with-your-hugo-site.com/css/style.css" type="text/css" media="all">
	<link rel="stylesheet" id="bootstrap-css" href="http://replace-this-with-your-hugo-site.com/css/bootstrap.css" type="text/css" media="all">
	<link rel="stylesheet" id="main-css" href="http://replace-this-with-your-hugo-site.com/css/main.css" type="text/css" media="all">
	<link rel="stylesheet" id="font-awesome-css" href="http://replace-this-with-your-hugo-site.com/css/font-awesome.css" type="text/css" media="all">
	<link rel="stylesheet" id="font-flaticons-css" href="http://replace-this-with-your-hugo-site.com/css/flaticon.css" type="text/css" media="all">
	<link rel="stylesheet" id="font-lineaicons-css" href="http://replace-this-with-your-hugo-site.com/css/linea_iconfont.css" type="text/css" media="all">

	<link rel="stylesheet" href="http://replace-this-with-your-hugo-site.com/highlight/styles/monokai-sublime.css">

	<link rel="shortcut icon" href="http://replace-this-with-your-hugo-site.com/images/logo-min.png">
	<link rel="apple-touch-icon-precomposed" href="http://replace-this-with-your-hugo-site.com/images/logo-min.png">
	<link rel="apple-touch-icon-precomposed" sizes="72x72" href="http://replace-this-with-your-hugo-site.com/images/logo-min.png">
	<link rel="apple-touch-icon-precomposed" sizes="114x114" href="http://replace-this-with-your-hugo-site.com/images/logo-min.png">
	<meta name="theme-color" content="#00b19e">
	<style id="theme-custom-css">
	.message-form .form-group .placeholder {padding-bottom: 1px;}.message-form .form-group .placeholder label {    margin-bottom: 5px;}.lab-colored-submenu a {    color: #ee7c33 !important;}.lab-colored-submenu a:after {    background-color: #ee7c33 !important;}@media screen and (max-width: 480px){.second-slide-text {left: 15px;}.arrow-button {right: 15px;}}
	</style>		
	<style type="text/css">
	.recentcomments a{display:inline !important;padding:0 !important;margin:0 !important;}
	</style>
	
	
</head>
<body class="blog body-lg-skin-kalium-default wpb-js-composer js-comp-ver-4.12 vc_responsive">
	
	<div class="mobile-menu-wrapper">
		<div class="mobile-menu-container  ps-container ps-theme-default" data-ps-id="ba537358-e9f8-6c4b-b48f-7203ada951fd">
			<ul id="menu-main-menu" class="menu">
				
				<li  class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home "><a href="http://replace-this-with-your-hugo-site.com/">首页</a></li>
				
				<li  class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home "><a href="http://replace-this-with-your-hugo-site.com/posts">文章</a></li>
				
			</ul>
			<div class="single-blog-holder " style=" padding: 10px 30px;">
	    			<div class="author-info-placement-left">
		    			<div class="blog-author-holder has-no-description">
							<div class="author-avatar">
								<a href="http://replace-this-with-your-hugo-site.com/" class="author-link">
									<img alt="" src="http://replace-this-with-your-hugo-site.com/images/logo.jpg" srcset="" class="avatar avatar-192 photo" height="192" width="192">
								</a>	
							</div>
						</div>		    			
						<div class="details">
							<div class="date">
								<i class="icon icon-basic-male"></i>Weisd
							</div>
							<div class="date">
								<i class="icon icon-basic-geolocalize-05"></i>北京	
							</div>
							<div class="date">
								<i class="icon icon-basic-mail"></i>weishidavip@163.com	
							</div>
							<div class="date">
								<i class="icon icon-basic-link"></i>http://replace-this-with-your-hugo-site.com/	
							</div>
							<div class="date">
								<i class="icon icon-basic-laptop"></i>weishidavip@163.com	
							</div>
						</div>
	    			</div>
	    		</div>	
				
			<div class="ps-scrollbar-x-rail" style="left: 0px; bottom: 3px;">
				<div class="ps-scrollbar-x" tabindex="0" style="left: 0px; width: 0px;"></div>
			</div>
			<div class="ps-scrollbar-y-rail" style="top: 0px; right: 3px;">
				<div class="ps-scrollbar-y" tabindex="0" style="top: 0px; height: 0px;"></div>
			</div>
		</div>
	
	</div>

	<div class="mobile-menu-overlay"></div>
	
	

	
	
	<div class="sidebar-menu-wrapper menu-type-standard-menu sidebar-alignment-right menu-skin-light">
		<div class="sidebar-menu-container ps-container ps-theme-default ps-active-y" >
			<a class="sidebar-menu-close" href="#"></a>
			
			<div class="single-blog-holder ">
    			<div class="author-info-placement-left">
	    			<div class="blog-author-holder has-no-description">
						<div class="author-avatar">
							<a href="http://replace-this-with-your-hugo-site.com/" class="author-link">
								<img alt="" src="http://replace-this-with-your-hugo-site.com/images/logo.jpg" srcset="" class="avatar avatar-192 photo" height="192" width="192">
							</a>	
						</div>
					</div>		    			
					<div class="details">
						<div class="date">
							<i class="icon icon-basic-male"></i>Weisd
						</div>
						<div class="date">
							<i class="icon icon-basic-geolocalize-05"></i>北京	
						</div>
						<div class="date">
							<i class="icon icon-basic-mail"></i>weishidavip@163.com	
						</div>
						<div class="date">
							<i class="icon icon-basic-link"></i>http://replace-this-with-your-hugo-site.com/	
						</div>
						<div class="date">
							<i class="icon icon-basic-laptop"></i>weishidavip@163.com	
						</div>
					</div>
    			</div>
    		</div>
		
			<div class="ps-scrollbar-x-rail" style="left: 0px; bottom: 3px;">
				<div class="ps-scrollbar-x" tabindex="0" style="left: 0px; width: 0px;"></div>
			</div>
			<div class="ps-scrollbar-y-rail" style="top: 0px; height: 827px; right: -5px;">
				<div class="ps-scrollbar-y" tabindex="0" style="top: 0px; height: 547px;"></div>
			</div>
		</div>
	</div>

	<div class="sidebar-menu-disabler"></div>
	

	<div class="wrapper" id="main-wrapper">
		
		<header class="main-header menu-type-standard-menu">
			<div class="container">
				<div class="logo-and-menu-container">	
								
					<div class="menu-column">
						<div class="standard-menu-container menu-bar-root-items-hidden menu-skin-dark reveal-fade items-visible">
							<a class="menu-bar menu-skin-dark " href="#">
								<span class="ham"></span>
							</a>						
							<nav>
								<ul id="menu-main-menu-1" class="menu">

        							
        							<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-2328"><a href="http://replace-this-with-your-hugo-site.com/">首页</a></li>
        							
        							<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-2328"><a href="http://replace-this-with-your-hugo-site.com/posts">文章</a></li>
        							
        							
								</ul>
							</nav>
						</div>
					</div>
				</div>
			</div>
		</header>
<script type="text/javascript">
	var headerOptions = {"stickyMenu":false,"currentMenuSkin":"menu-skin-dark"};
</script>
<div class="single-blog-holder post-2931 post type-post status-publish format-standard has-post-thumbnail hentry category-magazine tag-envato tag-kalium tag-laborator tag-themeforest">
    <div class="container">
		<div class="blog-head-holder  do-lazy-load-on-shown nivo loading-finished">
		</div>
    	<div class="page-container">
			<div class="row">
				<div class="col-md-10 col-sm-9-x clearfix">
	    			<div class="row">
		    			<div class="col-xs-12">
			    			<div class="blog-content-holder">
					    		<div class="section-title blog-title">
						    		<h1>hello</h1>
						    		
						    	</div>
			    				<div class="post-content post-formatting">
			    				<pre><code>package main

import (
	&quot;flag&quot;
	&quot;net/http&quot;
	&quot;os&quot;

	&quot;path/filepath&quot;

	&quot;middleware/session&quot;
	templateMW &quot;middleware/template&quot;
	&quot;models&quot;
	&quot;modules/api&quot;
	&quot;modules/captcha&quot;
	&quot;modules/log&quot;
	&quot;modules/pongor&quot;
	&quot;modules/snowflake&quot;
	&quot;setting&quot;

	&quot;github.com/labstack/echo&quot;
	&quot;github.com/labstack/echo/engine&quot;
	&quot;github.com/labstack/echo/engine/fasthttp&quot;
	&quot;github.com/labstack/echo/engine/standard&quot;
	mw &quot;github.com/labstack/echo/middleware&quot;
)

var configPath string

func init() {
	pwd, _ := os.Getwd()
	flag.StringVar(&amp;configPath, &quot;c&quot;, filepath.Join(pwd, &quot;./src/cmd/main/app.toml&quot;), &quot;-c /path/to/app.toml config gile&quot;)
}

func bootstrap() {
	if err := setting.InitConf(configPath); err != nil {
		panic(err)
	}

	log.InitLogService(setting.Conf.Logs)

	// 初始化 mysql
	if err := models.InitModels(setting.Conf.Models); err != nil {
		panic(err)
	}
	// 初始化 redis
	models.InitRedis(setting.Conf.Redis)

	if err := session.InitSession(setting.Conf.Session); err != nil {
		panic(err)
	}

	captcha.InitCaptcha()

	snowflake.InitWorker(setting.Conf.WorkerId)
}

func main() {
	flag.Parse()

	bootstrap()

	start()

	// go func() {
	// 	log.Info(&quot;pprof listen on %s&quot;, setting.Conf.Web.Pprof)
	// 	log.Error(&quot;%v&quot;, http.ListenAndServe(setting.Conf.Web.Pprof, nil))
	// }()

	// Echo instance
	e := echo.New()

	// render
	render := pongor.GetRenderer(pongor.PongorOption{Directory: setting.Conf.Pongo.Directory, Reload: setting.Conf.Pongo.Reload})

	e.SetRenderer(render)

	// 固定返回值
	e.SetHTTPErrorHandler(func(err error, c echo.Context) {

		code := http.StatusInternalServerError
		msg := &quot;服务器错误&quot;

		switch err.(type) {
		case *echo.HTTPError:
			he := err.(*echo.HTTPError)
			code = he.Code
			msg = he.Message

			if code == http.StatusUnauthorized {
				if len(c.Response().Header().Get(echo.HeaderWWWAuthenticate)) &gt; 0 {
					c.Response().WriteHeader(http.StatusUnauthorized)
					return
				}
			}

		case *models.Err:
			log.Error(&quot;models ERR %s&quot;, err.Error())

			msg = &quot;数据操作失败&quot;

		default:
			// panic(err)
			log.Error(&quot;unknown ERR %T %v&quot;, err, err)
		}

		if e.Debug() {
			msg = err.Error()

			// 不显示 404错误信息
			if code != 404 {
				log.Error(&quot;%T, %v&quot;, err, err)
			}

		}

		if c.Request().Header().Get(&quot;X-Requested-With&quot;) == &quot;XMLHttpRequest&quot; {
			// ajax 请求 返回json
			c.JSON(http.StatusOK, api.RetErr(code, msg))
			return
		}

		c.Render(http.StatusOK, &quot;error.html&quot;, map[string]interface{}{&quot;code&quot;: code, &quot;msg&quot;: msg})

	})

	if setting.Conf.Web.Debug {
		e.SetDebug(true)
	}

	// Middleware
	if setting.Conf.AccessLog.Enable {
		file := setting.Conf.AccessLog.FilePath
		if len(file) &gt; 0 {

			os.Mkdir(filepath.Dir(file), os.ModePerm)

			f, err := os.OpenFile(file, os.O_CREATE|os.O_RDWR|os.O_APPEND, os.ModePerm)
			if err != nil {
				log.Error(&quot;AccessLog OpenFile failed : %v &quot;, err)
				err = nil
			}
			e.Use(mw.LoggerWithConfig(mw.LoggerConfig{Output: f}))
		} else {
			e.Use(mw.Logger())
		}
	}

	////////////////// middleware ///////////////

	e.Use(mw.Recover())
	e.Use(mw.Gzip())
	e.Use(session.Sessioner())
	e.Use(templateMW.GlobalData())

	e.Static(&quot;/public&quot;, setting.Conf.Web.StaticDir)

	// e.File(&quot;/favicon.ico&quot;, &quot;public/favicon.ico&quot;)
	e.Get(&quot;/favicon.ico&quot;, func(c echo.Context) error {
		return c.NoContent(http.StatusOK)
	})

	// Route =&gt; handler
	e.GET(&quot;/&quot;, func(c echo.Context) error {
		return c.String(http.StatusOK, &quot;Hello, World!\n&quot;)
	})

	// 验证码
	e.Get(&quot;/captcha/*.png&quot;, captcha.Server())

	// 路由
	router(e)
	// 测试路由
	// tester(e)

	var server engine.Server

	if setting.Conf.Web.Fasthttp {
		server = fasthttp.New(setting.Conf.Web.Listen)
	} else {
		server = standard.New(setting.Conf.Web.Listen)
	}

	log.Info(&quot;server use %T, listen on %s&quot;, server, setting.Conf.Web.Listen)
	// Start server
	e.Run(server)

}


</code></pre>

			    				</div>

				    			<div class="tags-holder">
				    				
				    			</div>		    				
				    		</div>
		    			</div>

						
	    			</div>
    			</div>
				<div class="col-md-2 col-sm-3-x col-xs-12  pull-right-md">
	    			<div class="author-info-placement-left">
		    			<div class="blog-author-holder has-no-description">
							<div class="author-avatar">
								<a href="http://replace-this-with-your-hugo-site.com/" class="author-link">
									<img alt="" src="http://replace-this-with-your-hugo-site.com/images/logo.jpg" srcset="" class="avatar avatar-192 photo" height="192" width="192">
								</a>	
							</div>
	
							<div class="author-details">
								<a href="http://replace-this-with-your-hugo-site.com/" class="author-link">		
									<span class="author-name">
										Weisd
									</span>
								</a>		
							</div>
						</div>		    			
						<div class="details">
							<div class="date">
								<i class="icon icon-basic-calendar"></i>2016-08-02 23:46	
							</div>
							
							<div class="category">
								<i class="icon icon-basic-folder-multiple"></i>
									
							</div>
						</div>
	    			</div>
    			</div>
    			
    		</div>

    		<div class="row">
				<div class="col-sm-12">
					<div class="post-controls">
						
						

							
						<a href="http://replace-this-with-your-hugo-site.com/posts/one/" class="next-post">
							<span class="next arrow">
								<i class="flaticon-arrow413"></i>
							</span>
							<span class="post-title">
								<em>下一篇</em>
								<strong>one</strong>
							</span>
						</a>
						
					</div>
				</div>
			</div>		
		</div>
    </div>
	
</div>
</div>	
	<footer id="footer" class="main-footer footer-bottom-horizontal">
		<div class="footer-bottom">
			<div class="container">
				<div class="footer-bottom-content">
					<div class="footer-content-right">
						<ul class="social-networks textual">
							
						</ul>					
					</div>
					
					<div class="footer-content-left">
						<div class="copyrights">
							<p>© Copyright 2016. All Rights Reserved.</p>
						</div>
					</div>
				</div>
			</div>
		</div>
	</footer>
	<script type="text/javascript" src="http://replace-this-with-your-hugo-site.com/js/jquery.js"></script>
	
	
	
	
	
	
	
	
	<script type="text/javascript" src="http://replace-this-with-your-hugo-site.com/js/bootstrap.min.js"></script>
	<script type="text/javascript" src="http://replace-this-with-your-hugo-site.com/js/joinable.min.js"></script>
	
	<script type="text/javascript" src="http://replace-this-with-your-hugo-site.com/js/custom.min.js"></script>

	<script src="http://replace-this-with-your-hugo-site.com/highlight/highlight.pack.js"></script>
	<script>hljs.initHighlightingOnLoad();</script>
	
	
</body>
</html>